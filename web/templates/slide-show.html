<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DnR Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/slide-show.css') }}">
    <link rel="icon" href="{{ url_for('static', filename='icons/metrics-dashboard-icon.ico') }}" type="image/x-icon">
</head>
<body>
<!-- Loading overlay -->
<div class="loading-overlay" id="loadingOverlay">
    <div class="loading-spinner"></div>
</div>

<!-- Floating particles background -->
<div class="particles" id="particles"></div>

<!-- Top Navigation Bar -->
<div class="top-nav">
    <div class="nav-burger" onclick="toggleMenu()">
        <img src="{{ url_for('static', filename='icons/burger.svg') }}" alt="Menu" class="nav-icon">
    </div>
    <!-- Title can be added here if needed in the future -->
    <div id="burgerMenu" class="burger-menu-content" style="display:none;">
        <a href="/xsoar">XSOAR Dashboard</a>
        <a href="/msoc-form">MSOC Form</a>
        <a href="/speak-up-form">Speak Up Form</a>
        <a href="/xsoar-ticket-import-form">XSOAR Ticket Import</a>
        <a href="/travel-form">Travel Form</a>
        <a href="/red-team-testing-form">Red Team Testing</a>
        <a href="/apt-other-names-search">APT Other Names Search</a>
        <!-- Add more links as needed -->
    </div>
</div>

<div class="slider-container">
    <div class="slides">
        {% for filename in image_files %}
        <figure>
            <img src="{{ url_for('static', filename=filename) }}" alt="{{ filename }}">
        </figure>
        {% endfor %}
    </div>
</div>
<img src="{{ url_for('static', filename='icons/circle-left-solid.svg') }}" alt="Left Arrow" class="arrow left" onclick="moveSlide(-1)">
<img src="{{ url_for('static', filename='icons/circle-right-solid.svg') }}" alt="Right Arrow" class="arrow right" onclick="moveSlide(1)">
<div class="nav-buttons">
    {% for image_file in image_files %}
    <button data-slide-index="{{ loop.index0 }}" class="nav-dot"></button>
    {% endfor %}
</div>
<img id="reloadButton" src="{{ url_for('static', filename='icons/reload.svg') }}" alt="Reload" class="reload-icon" onclick="restartSlideshow()">
<img id="pausePlayButton" onclick="toggleSlideshow()" src="{{ url_for('static', filename='icons/pause-solid.svg') }}" alt="Pause">

<audio id="music" src="" loop muted></audio>
<img src="/static/icons/volume-xmark-solid.svg" alt="Unmute Icon" class="music-icon" id="music-icon" onclick="toggleAudio()">
<script src="/static/js/common.js"></script>
<script src="/static/js/slide-show.js"></script>
<script>
    initRandomMusic();

    function toggleMenu() {
        var menu = document.getElementById('burgerMenu');
        menu.style.display = (menu.style.display === 'none' || menu.style.display === '') ? 'block' : 'none';
    }

    // Close menu when a link is clicked
    document.addEventListener('DOMContentLoaded', function () {
        var burgerMenu = document.getElementById('burgerMenu');
        if (burgerMenu) {
            burgerMenu.querySelectorAll('a').forEach(function (link) {
                link.addEventListener('click', function () {
                    burgerMenu.style.display = 'none';
                });
            });
        }
    });

    // Close burger menu when clicking outside
    document.addEventListener('click', function (e) {
        var burgerMenu = document.getElementById('burgerMenu');
        var navBurger = document.querySelector('.nav-burger');

        // Check if the click was outside the menu and burger button
        if (burgerMenu && !burgerMenu.contains(e.target) && !navBurger.contains(e.target)) {
            burgerMenu.style.display = 'none';
        }
    });

    function restartSlideshow() {
        currentSlide = 0;
        updateSlider();
        // If paused, also resume the slideshow
        if (pausePlayButton.src.split('/').pop() === "play-solid.svg") {
            playSlideshow();
            pausePlayButton.src = "/static/icons/pause-solid.svg";
        }
    }

    // Hide loading overlay after content is fully loaded
    window.addEventListener('load', function () {
        var loadingOverlay = document.getElementById('loadingOverlay');
        if (loadingOverlay) {
            loadingOverlay.style.opacity = '0';
            setTimeout(function () {
                loadingOverlay.style.display = 'none';
            }, 500);
        }
    });

    // Floating particle effect initialization
    document.addEventListener('DOMContentLoaded', function () {
        var particles = document.getElementById('particles');
        if (particles) {
            for (var i = 0; i < 100; i++) {
                var particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + 'vw';
                particle.style.animationDelay = Math.random() * 6 + 's';
                particle.style.animationDuration = (Math.random() * 3 + 3) + 's';
                particle.style.opacity = Math.random() * 0.6 + 0.2;
                particles.appendChild(particle);
            }
        }
    });
</script>
</body>
</html>