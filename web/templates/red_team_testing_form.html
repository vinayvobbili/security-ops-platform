<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Red Team Testing Request Form</title>
    <link rel="stylesheet" href="/static/red_team_testing_form.css">
    <style>
        .top-nav {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 48px;
            display: flex;
            align-items: flex-start;
            z-index: 1000;
        }

        .nav-home {
            position: relative;
            margin-left: 8px;
            margin-top: 8px;
            z-index: 2;
        }

        .nav-icon {
            width: 28px;
            height: 28px;
            cursor: pointer;
        }

        .music-icon {
            position: fixed;
            top: 12px;
            right: 20px;
            width: 28px;
            height: 28px;
            cursor: pointer;
            z-index: 1100;
        }

        body {
            padding-top: 0;
            overflow-y: scroll; /* Always show vertical scroll bar */
            margin-bottom: 0;
        }

        .form-container {
            margin-bottom: 0;
            padding-bottom: 0;
        }
    </style>
</head>
<body>
<div class="top-nav">
    <a href="/" class="nav-home">
        <img src="/static/icons/home.svg" alt="Home" class="nav-icon">
    </a>
</div>
<div class="form-container">
    <h2>Red Team Testing Notification Form</h2>
    <form id="red-team-testing-form" method="post" action="/submit-red-team-testing-form">
        <div class="form-group">
            <label for="usernames">Usernames (comma-separated):</label><br>
            <textarea id="usernames" name="usernames" rows="2"></textarea>
        </div>
        <div class="form-group">
            <label for="tester_hosts">Tester IPs, CIDR Blocks, Hostnames (comma-separated):</label><br>
            <textarea id="tester_hosts" name="tester_hosts" rows="2"></textarea>
        </div>
        <div class="form-group">
            <label for="targets">Targets to be tested (IPs, CIDR Blocks, Hostnames, comma-separated):</label><br>
            <textarea id="targets" name="targets" rows="2"></textarea>
        </div>
        <div class="form-group">
            <label for="description">Description:</label><br>
            <textarea id="description" name="description" rows="3" required></textarea>
        </div>
        <div class="form-group">
            <label for="notes_scope">Notes/Scope:</label><br>
            <textarea id="notes_scope" name="notes_scope" rows="2"></textarea>
        </div>
        <div class="form-group" style="display: flex; align-items: center; gap: 1rem;">
            <label for="keep_until" style="margin-bottom: 0; white-space: nowrap;">Keep Until:</label>
            <input type="date" id="keep_until" name="keep_until" class="keep-until-date"
                   min="{{ tomorrow }}" value="{{ tomorrow }}">
            <span style="white-space: nowrap; color: #555; font-size: 0.98em;">5 PM ET</span>
        </div>
        <div class="form-group" style="display: flex; align-items: center; gap: 1rem;">
            <label for="email_local" style="margin-bottom: 0; white-space: nowrap;">Your email address:</label>
            <input type="text" id="email_local" name="email_local" style="width: 180px; margin-right:0;" placeholder="username" required>
            <span style="white-space: nowrap; margin-left:0;">@company.com</span>
        </div>
        <div style="display: flex; flex-direction: row; gap: 0.5rem; align-items: center; justify-content: flex-end;">
            <button type="button" class="current-entries-btn" onclick="window.open('http://gdnr.company.com/get-approved-testing-entries', '_blank')">Current Entries</button>
            <button type="submit">Submit</button>
        </div>
    </form>
    <div class="loading" id="loading" style="display:none;">
        <div class="loading-spinner"></div>
        <p>Processing your request...</p>
    </div>
    <div id="result"></div>
    <dialog id="successDialog">
        <form method="dialog">
            <h3 id="dialogHeading">Entry submitted successfully</h3>
            <div id="entryDetails"></div>
            <button id="okBtn" type="submit">OK</button>
        </form>
    </dialog>
    <audio id="music" src="/static/audio/inspirational-uplifting-calm-piano-254764.mp3" loop muted></audio>
    <img src="/static/icons/volume-xmark-solid.svg" alt="Unmute Icon" class="music-icon" id="music-icon" onclick="toggleAudio()">
</div>
<script src="/static/red_team_testing_form.js"></script>
<script>
    function toggleAudio() {
        const music = document.getElementById('music');
        const icon = document.getElementById('music-icon');
        if (music.muted) {
            music.muted = false;
            music.play();
            icon.src = '/static/icons/volume-high-solid.svg';
        } else {
            music.muted = true;
            music.pause();
            icon.src = '/static/icons/volume-xmark-solid.svg';
        }
    }

    // Auto-play music if not muted (user interaction required by browsers)
    document.addEventListener('DOMContentLoaded', function () {
        const music = document.getElementById('music');
        const icon = document.getElementById('music-icon');
        music.pause();
        icon.src = '/static/icons/volume-xmark-solid.svg';
    });
</script>
</body>
</html>
