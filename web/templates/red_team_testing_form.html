{% extends 'base_layout.html' %}

{% block page_title_plain %}Red Team Testing Request Form{% endblock %}

{% block extra_css %}<link rel="stylesheet" href="{{ url_for('static', filename='css/red_team_testing_form.css') }}">{% endblock %}

{% block body_classes %}red-team-testing-page{% endblock %}

{% set page_title_text = 'Red Team Testing Notification' %}
{% set page_title_left_icon = 'üß™' %}
{% set page_title_right_icon = 'üõ°Ô∏è' %}

{% block content %}
<div class="form-container">
    <h2>Red Team Testing Notification Form</h2>
    <form id="red-team-testing-form" method="post" action="/submit-red-team-testing-form">
        <div class="form-group">
            <label for="usernames">Usernames (comma-separated):</label><br>
            <textarea id="usernames" name="usernames" rows="2"></textarea>
        </div>
        <div class="form-group">
            <label for="tester_hosts">Tester IPs, CIDR Blocks, Hostnames (comma-separated):</label><br>
            <textarea id="tester_hosts" name="tester_hosts" rows="2"></textarea>
        </div>
        <div class="form-group">
            <label for="targets">Targets to be tested (IPs, CIDR Blocks, Hostnames, comma-separated):</label><br>
            <textarea id="targets" name="targets" rows="2"></textarea>
        </div>
        <div class="form-group">
            <label for="description">Description:</label><br>
            <textarea id="description" name="description" rows="3" required></textarea>
        </div>
        <div class="form-group">
            <label for="notes_scope">Notes/Scope:</label><br>
            <textarea id="notes_scope" name="notes_scope" rows="2"></textarea>
        </div>
        <div class="form-group inline-field-container">
            <label for="keep_until" class="inline-label">Keep Until:</label>
            <input type="date" id="keep_until" name="keep_until" class="keep-until-date"
                   min="{{ tomorrow }}" value="{{ tomorrow }}">
            <span class="field-suffix">5 PM ET</span>
        </div>
        <div class="form-group inline-field-container">
            <label for="email_local" class="inline-label">Your email address:</label>
            <input type="text" id="email_local" name="email_local" class="email-input" placeholder="username" required>
            <span class="field-suffix">@{{ config.email_domain }}</span>
        </div>
        <div style="display: flex; flex-direction: row; gap: 1rem; align-items: center; justify-content: space-between;">
            <button type="button" class="current-entries-btn" onclick="window.open('/get-approved-testing-entries', '_blank')">Current Entries</button>
            <button type="submit">Submit</button>
        </div>
    </form>
    <div class="loading" id="loading" style="display:none;">
        <div class="loading-spinner"></div>
        <p>Processing your request...</p>
    </div>
    <div id="result"></div>
    <dialog id="successDialog">
        <form method="dialog">
            <h3 id="dialogHeading">Entry submitted successfully</h3>
            <div id="entryDetails"></div>
            <button id="okBtn" type="submit">OK</button>
        </form>
    </dialog>
</div>
{% endblock %}

{% block extra_js %}<script src="{{ url_for('static', filename='js/red_team_testing_form.js') }}"></script>{% endblock %}
